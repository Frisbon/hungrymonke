# --- builder ---
FROM node:lts AS frontend-builder
WORKDIR /app/webui
COPY webui/ /app/webui
RUN yarn install --no-progress --network-timeout 600000
# match con il correttore: se non esiste build-prod, lo aliasiamo (vedi package.json)
RUN yarn run build-prod || yarn run build

# --- runtime ---
FROM nginxinc/nginx-unprivileged:stable
COPY --from=frontend-builder /app/webui/dist /usr/share/nginx/html
# niente EXPOSE necessario (l'immagine ascolta su 8080)
