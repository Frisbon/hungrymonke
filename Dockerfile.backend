FROM golang:1.17-alpine AS builder
WORKDIR /app
COPY . .
RUN go build -o /app/webapi ./cmd/webapi/main.go

FROM alpine:latest
WORKDIR /app
ENV GIN_MODE=release
# binary
COPY --from=builder /app/webapi .
# assets required at runtime
COPY --from=builder /app/service/api/pictureslol ./service/api/pictureslol
# (optional) docs; comment this if the folder doesn't exist in your tree
# COPY --from=builder /app/doc ./doc
EXPOSE 3000
CMD ["./webapi"]
